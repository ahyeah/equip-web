@model WebApp.Controllers.A2Controller.index2model
@{
    ViewBag.Title = "Index2";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}

@*<link rel="stylesheet" href="~/Plugins/AdminLTE/plugins/datatables/extensions/TableTools/css/dataTables.tableTools.css" />*@

<section class="content" style="background-color: #ecf0f5;" >
    <div class="box box-primary">
        <div class="box-header with-border bg-gray">
            <h3 class="box-title" style="font: medium bold; font-family:SimHei;color:red">A2-目标计划</h3>
        </div>
        <div class="box-body">
            <div class="row">
                @if (Model.isSubmit == 1)
{
    <div class="box-body">

        @if ((@ViewBag.user_specis as string).Split(',').Contains("动"))
        {


            <div class="col-xs-6 col-md-3">
                <a id="Add" class="btn btn-block btn-social btn-info" onclick="Create1()">
                    <i class="fa fa-pencil-square-o"></i>动专业提报设备绩效评估表
                </a>
            </div>
        }
     
            @if ((@ViewBag.user_specis as string).Split(',').Contains("静"))
            {
                //在此写满足上述条件的代码
                <div class="col-xs-6 col-md-3">
                    <a id="Add" class="btn btn-block btn-social btn-info" onclick="Create3()">
                        <i class="fa fa-pencil-square-o"></i>静专业提报设备绩效评估表
                    </a>
                </div>
            }
        </div>
                    
                    <div style="row">
                        <div class="box-body">
                            @if ((@ViewBag.user_specis as string).Split(',').Contains("电"))
                            {
                                //在此写满足上述条件的代码
                                <div class="col-xs-6 col-md-3">
                                    <a id="Add" class="btn btn-block btn-social btn-info" onclick="Create4()">
                                        <i class="fa fa-pencil-square-o"></i>电气专业提报设备绩效评估表
                                    </a>
                                </div>
                            }

                            @if ((@ViewBag.user_specis as string).Split(',').Contains("仪"))
                            {
                                //在此写满足上述条件的代码
                                <div class="col-xs-6 col-md-3">
                                    <a id="Add" class="btn btn-block btn-social btn-info" onclick="Create5()">
                                        <i class="fa fa-pencil-square-o"></i>仪表专业提报设备绩效评估表
                                    </a>
                                </div>
                            }
                        </div>
            <div style="row">
@if ((@ViewBag.rolename as string).Split(',').Contains("片区长") || ViewBag.curuser == "sa")
{
    <div class="box-body">
        <div class="col-xs-6 col-md-3">
            <a id="Add" class="btn btn-block btn-social btn-info" onclick="Create2()">
                <i class="fa fa-pencil-square-o"></i>企业级提报设备绩效评估表
            </a>
        </div>
    </div>

}
                                    </div>


            
        </div>
}
    </div>
        </div>
    <div class="box">



        <!-- /.box-header -->
        <div class="box-body table-responsive no-padding">
            <div class="row">
                <div class="row">
                    <div class="col-xs-6 col-md-3">
                    </div>
                </div>
                <div class="col-xs-12">
                    <table>
                        <tr>

                            <td class="col-sm-12">
                                <div class="form-group">
                                    <input type="text" id="month" hidden="hidden" value="@ViewBag.Month">
                                    <input type="text" id="curuser" hidden="hidden" value="@ViewBag.curuser">
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">查询方式</label>
                                        <div id="Pianqu_Select" class="col-sm-10">
                                            <select class="form-control select2" style="width: 100%;" id="chaxunmethod" name="chaxunmethod" onchange="listchaxun()">
                                                <option value="">请选择</option>
                                                <option value="qc">全厂</option>
                                                <option value="cj">车间</option>
                                                <option value="zz">装置</option>

                                            </select>
                                        </div>
                                    </div>
                                    <div id="zzcjchaxun">
                                        <!--装置查询-->
                                        <div id="zzchaxun">
                                            <div class="form-group">
                                                <label class="col-sm-2 control-label">车间</label>
                                                <div id="Equip_Select" class="col-sm-10">
                                                    <select class="form-control select2" style="width: 100%;" id="cjname" name="cjname" onchange="list_Zz()">
                                                        <option value="">请选择</option>
                                                        @if (Model.UserHasEquips != null)
                                                        {
                                                            foreach (var item in Model.UserHasEquips)
                                                            {
                                                                <option value="@item.EA_Id">@item.EA_Name</option>
                                                            }
                                                        }
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-sm-2 control-label">装置</label>
                                                <div id="Equip_Select" class="col-sm-10">
                                                    <select class="form-control select2" style="width: 100%;" id="zzId" name="zzname" onchange="hidebutton_datatable()">
                                                        <!-- 隐藏button和datatable-->
                                                        <option value="">请选择</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <!--车间查询-->
                                        <div id="cjchaxun">
                                            <label class="col-sm-2 control-label">车间</label>
                                            <div id="Equip_Select" class="col-sm-10">
                                                <select class="form-control select2" style="width: 100%;" id="cjname_1" name="cjname_1" onchange="list_Zz()">
                                                    <option value="">请选择</option>
                                                    @if (Model.UserHasEquips != null)
                                                    {
                                                        foreach (var item in Model.UserHasEquips)
                                                        {
                                                            <option value="@item.EA_Id">@item.EA_Name</option>
                                                        }
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">查询年份</label>

                                    <div id="chaxunyear" class="col-sm-10">
                                        <select class="form-control select2" style="width: 100%;" id="SearchYear" onchange="hidebutton_datatable()">
                                            <option value="2017">2017年</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label class="col-sm-2 control-label">查询月份</label>

                                    <div id="chaxuntime" class="col-sm-10">
                                        <select class="form-control select2" style="width: 100%;" id="SearchMonth" onchange="hidebutton_datatable()">
                                            <option value="@ViewBag.Month">@ViewBag.Monthname</option>
                                            <option value="1">一月（12月15至1月15）</option>
                                            <option value="2">二月（1月15至2月15）</option>
                                            <option value="3">三月（2月15至3月15）</option>
                                            <option value="4">四月（3月15至4月15）</option>
                                            <option value="5">五月（4月15至5月15）</option>
                                            <option value="6">六月（5月15至6月15）</option>
                                            <option value="7">七月（6月15至7月15）</option>
                                            <option value="8">八月（7月15至8月15）</option>
                                            <option value="9">九月（8月15至9月15）</option>
                                            <option value="10">十月（9月15至10月15）</option>
                                            <option value="11">十一月（10月15至11月15）</option>
                                            <option value="12">十二月（11月15至12月15）</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">查询专业</label>
                                    <div id="Equip_Select" class="col-sm-10">
                                    
                                        <select class="form-control select2" style="width: 100%;" id="zy" onchange="hidebutton_datatable()">

                                            <option value="企业">企业级</option>
                                            <option value="动">动设备专业</option>
                                            <option value="静">静设备专业</option>
                                            <option value="电">电气专业</option>
                                            <option value="仪">仪表专业</option>
                                        </select>
                                    </div>
                                </div>
                            </td>
                            <td class="col-sm-4">
                                <button type="button" class="btn btn-warning" onclick="Search()">查询</button>
                            </td>
                        </tr>

                    </table>

                </div>

                <div class="row">
                    <div class="col-xs-6 col-md-3">
                        <p></p>
                    </div>
                </div>

                <div class="col-xs-12">
                    <div id="example1table">
                        <form class="form-horizontal" role="form">
                            <table id="example1" class="table table-hover table-bordered">
                                <caption style="text-align:center;color:red;font-size:x-large" id="kpi_title">KPI指标统计</caption>
                                <thead>
                                    <tr>
                                        <th>指标类型</th>
                                        <th>指标名称</th>
                                        <th>年度目标值</th>
                                        <th>累计值</th>
                                        <th>当月完成值</th>
                                        <th>趋势图</th>

                                    </tr>
                                </thead>
                                <tbody id="tbody"></tbody>


                            </table>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
        <!--提交按钮-->
    <div class="col-sm-offset-2 col-sm-10" id="submitchoose">
        @*@if($('#zy').find("Option:selected").text()=="企业"){
            
        }*@
        <div id="submitqiye">
        <button class="btn btn-primary col-sm-offset-4" type="button" onclick="submit_clickQiYe()">保存</button>
            </div>
        <div id="submitdong">
            <button class="btn btn-primary col-sm-offset-4" type="button" onclick="submit_clickDong()">保存</button>
        </div>
        <div id="submitjing">
            <button class="btn btn-primary col-sm-offset-4" type="button" onclick="submit_clickJing()">保存</button>
        </div>
        <div id="submitdian">
            <button class="btn btn-primary col-sm-offset-4" type="button" onclick="submit_clickDian()">保存</button>
        </div>
        <div id="submityi">
            <button class="btn btn-primary col-sm-offset-4" type="button" onclick="submit_clickYi()">保存</button>
        </div>

    </div>
    </div>
</section>
<div class="modal fade" id="qst" tabindex="-1" role="dialog"
     aria-labelledby="qst_title" aria-hidden="true">
    <div class="modal-dialog" style="width:800px;height:800px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close"
                        data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="qst_title">
                    趋势图
                </h4>
            </div>
            <div class="modal-body" id="qst_graphic" style="width:700px;height:50%">
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

@section js{
    <!-- Page script -->
    <script src="~/Plugins/AdminLTE/plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="~/Plugins/AdminLTE/plugins/datatables/dataTables.bootstrap.min.js"></script>
    <script src="~/Plugins/AdminLTE/plugins/daterangepicker/moment.js"></script>
    <script src="~/Plugins/AdminLTE/plugins/daterangepicker/daterangepicker.js"></script>

    <script src="~/Plugins/AdminLTE/plugins/datatables/extensions/Select/js/dataTables.select.min.js"></script>
    @*<script src="~/Plugins/AdminLTE/plugins/datatables/extensions/TableTools/js/dataTables.tableTools.js"></script>*@
    <script src="~/Plugins/AdminLTE/plugins/chartjs/Chart.js"></script>
    <script src="~/Scripts/highcharts.js"></script>
    <script src="~/Scripts/jquery.form.js"></script>
    <script type="text/javascript">
        function PageLoad() {
            $("#zzcjchaxun").hide();
            $("#submitchoose").hide();
            
        };
        $(document).ready(
            PageLoad());
        $(function () {
            $("thead").css("background", "#7CCD7C");
            $("tbody tr").addClass("info");
        });
        function graphic_show(grahpic_name, graphic_zdm) {//字段名字和字段名
            //var signal = $(this).parents("button").parents("td").parents("tr").find("td:eq(1)").text();
            //alert($("#example1 tr:eq(1) td:nth-child(2)").text());
            //alert(signal);
            //选择全厂时候的趋势图以及默认初始查询页面的趋势图
            if ($('#chaxunmethod').find("option:selected").text() == "全厂" || $('#chaxunmethod').find("option:selected").text() == "请选择") {

                //if ($('#chaxunmethod').find("option:selected").text() == "全厂")               
                graphic_zy = $('#zy').find("option:selected").text();
                graphic_subdipartment = "全厂";
                $.ajax({

                    url: '/A2/qstqc',

                    type: 'post',
                    dataType: 'json',
                    data: {
                        "grahpic_name": grahpic_name,
                        "graphic_zdm": graphic_zdm,
                        "graphic_zy": graphic_zy,
                        "graphic_subdipartment": graphic_subdipartment,
                    },

                    success: function (data) {

                        //highchart中xAxis的categories与yAxis中series的data所需的格式均为Array，yAxis中的Array必须为数值，xAxis则任意格式
                        var dataforqst = new Array();
                        zz = data.toString().split(",$$,");

                        dataforqst = zz[0].split(",");
                        //将dataforqst中的值由字符串变为数值
                        for (i = 0; i < dataforqst.length; i++) {
                            dataforqst[i] = parseFloat(dataforqst[i]);
                        }
                        var xArray = new Array();
                        xArray = zz[1].split(",");
                        for (j = 0; j < xArray.length; j++) {
                            xArray[j] = xArray[j].toString().substr(2, 5);

                        }
                        $('#qst').modal('show');

                        $('#qst_graphic').highcharts({
                            chart: {
                                type: 'line'
                            },
                            title: {
                                text: '历史曲线',
                                x: -20 //center
                            },

                            xAxis: {
                                categories: xArray,
                                title: {
                                    text: '月份'
                                },
                            },
                            yAxis: {
                                title: {
                                    text: '数值'
                                },
                            },
                            plotOptions: {
                                line: {
                                    dataLabels: {
                                        enabled: true
                                    },
                                    enableMouseTracking: false
                                }
                            },
                            series: [{
                                name: grahpic_name,
                                data: dataforqst
                            }]
                        });

                    },

                    error: function (err) {
                        alert(err.toString());
                    }
                });
            }
            if ($('#chaxunmethod').find("option:selected").text() == "装置") {
                //查询装置趋势图
            }
        }

        //function Search() {

        //    location.href = "/A2/newgetRecord?time=" + $('#SearchMonth').val();
        //}

        function outputExcel_click() {
            if (!confirm('即将导出时间段内数据，若尚未选择时间则默认导出本月数据！'))
                return false;

            // var wef_id = $("#wef_id").val();
            $.ajax({
                type: 'POST',
                url: '/A2/OutputExcel?time=' + $('#reservationtime').val(),
                success: function (data) {
                    //alert(data);
                    location.href = data;
                },
                error: function () {
                    alert('error');
                }
            });
        }

    </script>

    <script>

    function hidebutton_datatable() {
        $('#example1table').hide();//将datatable隐藏起来
        $('#submitchoose').hide();//将按钮隐藏
    }
    function Create1() {//动专业的提交页面跳转
        location.href = "/A2/DongSubmit";
    }
    function Create2() {//企业级的跳转

        location.href = "/A15dot1qiye/Submit";
    }
    function Create3() {//静专业级的跳转
        location.href = "/A15dot1jing/Submit";
    }
    function Create4() {//电气专业级的跳转
        location.href = "/A15dot1Dian/Submit";
    }
    function Create5() {//仪表专业级的跳转
        location.href = "/A15dot1Yi/Submit";
    }
    function list_Zz() {
        $('#example1table').hide();//将datatable隐藏起来
        $('#submitchoose').hide();//将提交按钮隐藏起来
        alert($('#zy').val());
        alert($('#cjname').val());
        
        if ($('#cjname').val() != "") {
            $.ajax({
                url: '/A2/A2Cj_Zzs',
                type: 'post',
                data: {
                    "cj_id": $('#cjname').find("Option:selected").text(),
                    "zy": $('#zy').val()
                },
           
                success: function (backdata) {
                    if (backdata) {
                        var itemHtml = "<option value=\"\">" + "请选择" + "</option>";
                        for (var i = 0; i < backdata.length; i++) {
                            itemHtml = itemHtml + "<option value=\"" + backdata[i].Zz_Id + "\">" + backdata[i].Zz_Name + "</option>";
                        }
                        $('#zzId').html(itemHtml);
                    }
                    else {
                        alert("error!!!");
                    }
                },
                error: function () {
                    alert('error');
                }
            })
        }
    }

    function listchaxun() {
        $('#example1table').hide();//将datatable隐藏起来
        $('#submitchoose').hide();
        
        if ($('#chaxunmethod').val() == "cj") {//如果查询方式是车间
            
            $('#zzcjchaxun').show();
            $("#zzchaxun").hide();
            $("#cjchaxun").show();
            
            
        } else {
            if ($('#chaxunmethod').val() == "qc") {//如果选择查询方式是全厂
                
                $("#zzcjchaxun").hide();
         
            } else {
                if ($('#chaxunmethod').val() == "zz") {//如果查询方式是装置
                    $('#zzcjchaxun').show();
                    $("#cjchaxun").hide();
                    $("#zzchaxun").show();

                } else {
                    alert("请选择查询方式")
                }
            }


        }
    }

    function Search() {
        @*var bbs = (("@ViewBag.rolename").Contains("管理员"));
        alert(bbs);*@

        //alert('1');
        //alert($('#zzId').find("Option:selected").text());
        //alert($('#zy').find("Option:selected").text());
        $('#example1table').show();//将datatable显示

        var adminqx = ("@ViewBag.rolename" ).indexOf("管理员");//管理员权限
        if (adminqx == "-1") {

            adminqx = "false";//没有管理员权限

        } else {
            adminqx = "true";//有管理员权限

        }
        
        var s = '请选择';
        var zzid = "";
        if (s == $('#zzId').find("Option:selected").text() && $('#chaxunmethod').find("Option:selected").text() == "装置") {
            alert("未填写装置");
            $('#example1table').hide();
            return false;
        }
        else if ($('#chaxunmethod').find("Option:selected").text() == "请选择") {
            alert("未填写查询方式");
            $('#example1table').hide();
            return false;
        } else if (s == $('#cjname_1').find("Option:selected").text() && $('#chaxunmethod').find("Option:selected").text() == "车间") {
            alert("未填写车间");
            $('#example1table').hide();
            return false;
        } else if (s == $('#cjname').find("Option:selected").text() && $('#chaxunmethod').find("Option:selected").text() == "装置") {
            alert("未填写车间");
            $('#example1table').hide();
            return false;
        }
        else if ($('#chaxunmethod').find("Option:selected").text() == "全厂") {
            //alert("qc");
            zzid = "全厂";
        }
        else if ($('#chaxunmethod').find("Option:selected").text() == "装置") {
            zzid = $('#zzId').val();
        }
        var str = "/A2/newgetRecord?time=" + $('#SearchMonth').val() + "&zzid=" + zzid + "&zy=" + $('#zy').find("Option:selected").text() +"&cjname="+ $('#cjname_1').find("Option:selected").text() +"&chaxunmethod="+ $('#chaxunmethod').find("Option:selected").text()
        $('#example1').DataTable().ajax.url(str).load(function (json) {
            if (json.data.length < 1) {
                $('#submitchoose').hide();//如果没有查询到值就讲提交按钮全部隐藏
            }
            // alert(json.data[0].zdm);rolename.Contain("管理员")
        });
        if ($('#zy').find("Option:selected").text() == "企业级" && (adminqx=="true")) {//根据专业选择保存按钮adminqx为true或false表示管理员权限

            $('#submitchoose').show();
            $('#submitqiye').show();//显示企业级装置提报的按钮
            $('#submitdong').hide();
            $('#submitjing').hide();
            $('#submitdian').hide();
            $('#submityi').hide();

        }
        if ($('#zy').find("Option:selected").text() == "动设备专业" && (adminqx == "true")) {//根据专业选择保存按钮

            $('#submitchoose').show();
            $('#submitqiye').hide();
            $('#submitdong').show();
            $('#submitjing').hide();
            $('#submitdian').hide();
            $('#submityi').hide();

        }
        if ($('#zy').find("Option:selected").text() == "静设备专业" && (adminqx == "true")) {//根据专业选择保存按钮

            $('#submitchoose').show();
            $('#submitqiye').hide();
            $('#submitdong').hide();
            $('#submitjing').show();
            $('#submitdian').hide();
            $('#submityi').hide();


        }
        if ($('#zy').find("Option:selected").text() == "电气专业" && (adminqx == "true")) {//根据专业选择保存按钮

            $('#submitchoose').show();
            $('#submitqiye').hide();
            $('#submitdong').hide();
            $('#submitjing').hide();
            $('#submitdian').show();
            $('#submityi').hide();



        }
        if ($('#zy').find("Option:selected").text() == "仪表专业" && (adminqx == "true")) {//根据专业选择保存按钮

            $('#submitchoose').show();
            $('#submitqiye').hide();
            $('#submitdong').hide();
            $('#submitjing').hide();
            $('#submitdian').hide();
            $('#submityi').show();


        }




        //if ($('#chaxunmethod').find("Option:selected").text() != "装置" && $('#chaxunmethod').find("Option:selected").text() != "全厂") {
        //    $('#submitchoose').hide();//除了装置和全厂意外没有提报按钮
        //}
    }
    $(document).ready(function () {
        $("thead").css("background", "#7CCD7C");
        $("tbody tr").addClass("info");

        $("#reservationtime").daterangepicker({
            showDropdowns: true,
            locale: {
                applyLabel: '确定',
                cancelLabel: '取消',
                fromLabel: '起始时间',
                toLabel: '结束时间',
                customRangeLabel: '自定义',
                daysOfWeek: ['日', '一', '二', '三', '四', '五', '六'],
                monthNames: ['一月', '二月', '三月', '四月', '五月', '六月',
                    '七月', '八月', '九月', '十月', '十一月', '十二月'],
                firstDay: 1
            },
            format: 'YYYY-MM-DD', //控件中from和to 显示的日期格式



            arrows: true
        });


        $("#example1").DataTable({
            "oLanguage": {

                "sLengthMenu": "每页显示 _MENU_ 条记录",
                // "sZeroRecords": "抱歉， 没有找到",
                "sInfo": "从 _START_ 到 _END_ /共 _TOTAL_ 条数据",
                "sInfoEmpty": "没有数据",
                "sInfoFiltered": "(从 _MAX_ 条数据中检索)",
                "sZeroRecords": "没有检索到数据",
                "sSearch": "模糊查询:  ",
                "sProcessing": "<img src='/images/loading.gif'>  努力加载数据中.",
                "oPaginate": {
                    "sFirst": "首页",
                    "sPrevious": "前一页",
                    "sNext": "后一页",
                    "sLast": "尾页"
                }
            },

            pageLength: 15,
            columns: [
                    { data: 'zblx' },
                    { data: 'zbname' },
                    { data: 'ndmbz' },
                       {
                           data: 'ljz',
                       },
                    {
                        data: 'ActualValue',


                        "render": function (data, type, full, meta) {
                            if ("@ViewBag.curuser" == "sa" || "@ViewBag.curuser" == "武文斌")//只有sa和武文斌可以查询到的内容可以编辑
                            {
                                return '<input type="text" name="kpi" id="kpi" value="' + data + ' " class="form-control" >';//将这一组数据都取名为kpi便于后面取值
                            }
                            else {
                                return data;

                            }
                        }
                    },
                    {
                        data: 'id',//传入id的值用于存库和取值,以及判断趋势图的查询途径
                        "render": function (data, type, full, meta) {

                            return '<button type="button"id="kpiid"value="' + data + ' "  class="btn btn-primary" onclick="graphic_show(\'' + full.zbname + '\',\'' + full.zdm + '\')">查看</button></a>';
                        }
                    },
                     @*{
                                 "render": function (data, type, full, meta) {
                                     if ("@ViewBag.curuser" == "sa") {
                                         return '<input type="hidden" name="kpiid" id="kpiid" value="' + full.id + ' " class="form-control"  >';

                                     }
                                     else {
                                         return data;

                                     }
                                 }
                             }*@


            ],
            "ajax": {
                "url": "/A2/newgetRecord?time=" + $('#SearchMonth').val() + "&zzid=" + "全厂" + "&zy=" + "企业级",
                /*"data":  {
                   json1: '{"time": "' + $('#reservationtime').val()
                           + '",flow_Id: "' + $('#wf_name').val()
                           + '",equip_gycode: "' + $('#E_Code').val()
                               + '"}'
                },*/
                "type": "POST"




            },
            "bProcessing": true,
            "paging": true,
            "lengthChange": false,
            "searching": false,
            "ordering": false,
            "info": true,
            "autoWidth": false,

        });
    });







    //sa等人把查询得到的数据修改后的提交按钮
    function submit_clickQiYe() {

        var obj = document.getElementsByName('kpi'); //选择所有name="'KPI'"的对象，返回数组
        //取到对象数组后，我们来循环取出其中的值
        var s = '请选择';
        var submitdep = "";
        for (var i = 0; i < obj.length; i++) {
            if (obj[i].value == "") {
                alert("KPI指标中有未填项！");
                return false;
            }
        }
        if ($('#chaxunmethod').val() == "qc") {

            submitdep = "全厂";
            $.ajax({
                type: 'POST',
                url: '/A2/ModifyQiYe',
                data: {
                    json1: '{equipReliableExponent: "' + obj[0].value
                        + '", maintainChargeExponent: "' + obj[1].value
                        + '", thousandLXBrate: "' + obj[2].value
                        + '", thousandColdChangeRate: "' + obj[3].value
                        + '", instrumentControlRate: "' + obj[4].value
                        + '", eventNumber: "' + obj[5].value
                        + '", troubleKoufen: "' + obj[6].value
                        + '", projectLateRate: "' + obj[7].value
                        + '", trainAndAbility: "' + obj[8].value
                        + '", month: "' + $('#SearchMonth').val()//传入kpiid用于定位一行数据
                        + '", zzId: "' + submitdep
                        + '", cjname: "' + $('#cjname').find("Option:selected").text()
                        + '"}'
                },

                success: function (data) {

                    if (data) {
                        alert('操作已完成！');
                        location.href = "Index2";
                    } else {
                        alert('操作失败！');
                    }

                },
                error: function () {
                    alert('error');
                }
            });
        }
        else if ($('#chaxunmethod').val() == "zz") {
            if (s == $('#zzId').find("Option:selected").text()) {
                alert("未填写装置");
                return false;

            }
            else {
                submitdep = $('#zzId').find("Option:selected").text();
                $.ajax({
                    type: 'POST',
                    url: '/A2/ModifyQiYe',
                    data: {
                        json1: '{equipReliableExponent: "' + obj[0].value
                            + '", maintainChargeExponent: "' + obj[1].value
                            + '", thousandLXBrate: "' + obj[2].value
                            + '", thousandColdChangeRate: "' + obj[3].value
                            + '", instrumentControlRate: "' + obj[4].value
                            + '", eventNumber: "' + obj[5].value
                            + '", troubleKoufen: "' + obj[6].value
                            + '", projectLateRate: "' + obj[7].value
                            + '", trainAndAbility: "' + obj[8].value
                            + '", kpiid: "' + $('#kpiid').val()//传入kpiid用于定位一行数据
                            + '", zzId: "' + submitdep
                            + '", cjname: "' + $('#cjname').find("Option:selected").text()
                            + '"}'
                    },

                    success: function (data) {

                        if (data) {
                            alert('操作已完成！');
                            location.href = "Index2";
                        } else {
                            alert('操作失败！');
                        }

                    },
                    error: function () {
                        alert('error');
                    }
                });
            }

        }
        else if (($('#chaxunmethod').val() == "cj")) {
            //车间的保存方式

        }

    }
    function submit_clickDong() {

        var obj = document.getElementsByName('kpi'); //选择所有name="'KPI'"的对象，返回数组
        //取到对象数组后，我们来循环取出其中的值
        var s = '请选择';
        var submitdep = "";
        for (var i = 0; i < obj.length; i++) {
            if (obj[i].value == "") {
                alert("KPI指标中有未填项！");
                return false;
            }
        }
        if ($('#chaxunmethod').val() == "qc") {

            submitdep = "全厂";
            $.ajax({
                type: 'POST',
                url: '/A2/ModifyDong',
                data: {
                    json1: '{gzqdkf: "' + obj[0].value
                        + '", djzgzl: "' + obj[1].value
                        + '", gzwxl: "' + obj[2].value
                        + '", qtlxbmfxhl: "' + obj[3].value
                        + '", jjqxgsl: "' + obj[4].value
                        + '", gdpjwcsj: "' + obj[5].value
                        + '", jxmfpjsm: "' + obj[6].value
                        + '", zcpjsm: "' + obj[7].value
                        + '", sbwhl: "' + obj[8].value
                        + '", jxychgl: "' + obj[9].value
                        + '", zyjbpjxl: "' + obj[10].value
                        + '", jzpjxl: "' + obj[11].value
                        + '", wfjzgzl: "' + obj[12].value
                        + '", ndbtjbcfjxtc: "' + obj[13].value
                        + '", jbpjwgzjgsjMTBF: "' + obj[14].value
                        + '", month: "' + $('#SearchMonth').val()//传入kpiid用于定位一行数据
                        + '", zzId: "' + submitdep
                        + '", cjname: "' + $('#cjname').find("Option:selected").text()
                        + '"}'
                },

                success: function (data) {

                    if (data) {
                        alert('操作已完成！');
                        location.href = "Index2";
                    } else {
                        alert('操作失败！');
                    }

                },
                error: function () {
                    alert('error');
                }
            });
        }
        else if ($('#chaxunmethod').val() == "zz") {
            if (s == $('#zzId').find("Option:selected").text()) {
                alert("未填写装置");
                return false;

            }
            else {
                submitdep = $('#zzId').find("Option:selected").text();
                $.ajax({
                    type: 'POST',
                    url: '/A2/ModifyDong',
                    data: {
                        json1: '{gzqdkf: "' + obj[0].value
                         + '", djzgzl: "' + obj[1].value
                         + '", gzwxl: "' + obj[2].value
                         + '", qtlxbmfxhl: "' + obj[3].value
                         + '", jjqxgsl: "' + obj[4].value
                         + '", gdpjwcsj: "' + obj[5].value
                         + '", jxmfpjsm: "' + obj[6].value
                         + '", zcpjsm: "' + obj[7].value
                         + '", sbwhl: "' + obj[8].value
                           + '", jxychgl: "' + obj[9].value
                         + '", zyjbpjxl: "' + obj[10].value
                         + '", jzpjxl: "' + obj[11].value
                         + '", wfjzgzl: "' + obj[12].value
                         + '", ndbtjbcfjxtc: "' + obj[13].value
                         + '", jbpjwgzjgsjMTBF: "' + obj[14].value
                          + '", kpiid: "' + $('#kpiid').val()//传入kpiid用于定位一行数据
                             + '", zzId: "' + submitdep
                             + '", cjname: "' + $('#cjname').find("Option:selected").text()
                             + '"}'
                    },

                    success: function (data) {

                        if (data) {
                            alert('操作已完成！');
                            location.href = "Index2";
                        } else {
                            alert('操作失败！');
                        }

                    },
                    error: function () {
                        alert('error');
                    }
                });
            }

        }
        else if (($('#chaxunmethod').val() == "cj")) {
           //车间的保存方式

        }

    }
    function submit_clickJing() {

        var obj = document.getElementsByName('kpi'); //选择所有name="'KPI'"的对象，返回数组
        //取到对象数组后，我们来循环取出其中的值
        var s = '请选择';
        var submitdep = "";
        for (var i = 0; i < obj.length; i++) {
            if (obj[i].value == "") {
                alert("KPI指标中有未填项！");
                return false;
            }
        }
        if ($('#chaxunmethod').val() == "qc") {

            submitdep = "全厂";
            $.ajax({
                type: 'POST',
                url: '/A2/ModifyJing',
                data: {
                    json1: '{gzqdkf: "' + obj[0].value
                            + '", sbfsxlcs: "' + obj[1].value
                            + '", qtlhsbgs: "' + obj[2].value
                            + '", gylpjrxl: "' + obj[3].value
                            + '", hrqjxl: "' + obj[4].value
                            + '", ylrqdjl: "' + obj[5].value
                            + '", ylgdndjxjhwcl: "' + obj[6].value
                            + '", aqfndjyjhwcl: "' + obj[7].value
                            + '", sbfsjcjhwcl: "' + obj[8].value
                            + '", jsbjwxychgl: "' + obj[9].value
                            + '", kpiid: "' + $('#kpiid').val()//传入kpiid用于定位一行数据
                              + '", month: "' + $('#SearchMonth').val()//传入kpiid用于定位一行数据
                             + '", zzId: "' + submitdep
                            + '", cjname: "' + $('#cjname').find("Option:selected").text()
                            + '"}'
                },


                success: function (data) {

                    if (data) {
                        alert('操作已完成！');
                        location.href = "Index2";
                    } else {
                        alert('操作失败！');
                    }

                },
                error: function () {
                    alert('error');
                }
            });
        }
        else if ($('#chaxunmethod').val() == "zz") {
            if (s == $('#zzId').find("Option:selected").text()) {
                alert("未填写装置");
                return false;

            }
            else {
                submitdep = $('#zzId').find("Option:selected").text();
                $.ajax({
                    type: 'POST',
                    url: '/A2/ModifyJing',
                    data: {
                        json1: '{gzqdkf: "' + obj[0].value
                             + '", sbfsxlcs: "' + obj[1].value
                             + '", qtlhsbgs: "' + obj[2].value
                             + '", gylpjrxl: "' + obj[3].value
                             + '", hrqjxl: "' + obj[4].value
                             + '", ylrqdjl: "' + obj[5].value
                             + '", ylgdndjxjhwcl: "' + obj[6].value
                             + '", aqfndjyjhwcl: "' + obj[7].value
                             + '", sbfsjcjhwcl: "' + obj[8].value
                             + '", jsbjwxychgl: "' + obj[9].value
                             + '", kpiid: "' + $('#kpiid').val()//传入kpiid用于定位一行数据
                              + '", zzId: "' + submitdep
                             + '", cjname: "' + $('#cjname').find("Option:selected").text()
                             + '"}'
                    },

                    success: function (data) {

                        if (data) {
                            alert('操作已完成！');
                            location.href = "Index2";
                        } else {
                            alert('操作失败！');
                        }

                    },
                    error: function () {
                        alert('error');
                    }
                });
            }

        }
        if (($('#chaxunmethod').val() == "cj")) {
            //车间的保存方式

        }
    }


    function submit_clickDian() {
        var obj = document.getElementsByName('kpi'); //选择所有name="'KPI'"的对象，返回数组
        //取到对象数组后，我们来循环取出其中的值
        var s = '请选择';
        var submitdep = "";
        for (var i = 0; i < obj.length; i++) {
            if (obj[i].value == "") {
                alert("KPI指标中有未填项！");
                return false;
            }
        }
        if ($('#chaxunmethod').val() == "qc") {

            submitdep = "全厂";
            $.ajax({
                type: 'POST',
                url: '/A2/ModifyDian',
                data: {
                    json1: '{gzqdkf: "' + obj[0].value
                    + '", dqwczcs: "' + obj[1].value
                    + '", jdbhzqdzl: "' + obj[2].value
                    + '", sbgzl: "' + obj[3].value
                    + '", djMTBF: "' + obj[4].value
                    + '", dzdlsbMTBF: "' + obj[5].value
                    + '", zbglys: "' + obj[6].value
                    + '", dnjlphl: "' + obj[7].value
                        + '", month: "' + $('#SearchMonth').val()//传入kpiid用于定位一行数据
                        + '", zzId: "' + submitdep
                        + '", cjname: "' + $('#cjname').find("Option:selected").text()
                        + '"}'
                },

                success: function (data) {

                    if (data) {
                        alert('操作已完成！');
                        location.href = "Index2";
                    } else {
                        alert('操作失败！');
                    }

                },
                error: function () {
                    alert('error');
                }
            });
        }
        else if ($('#chaxunmethod').val() == "zz") {
            if (s == $('#zzId').find("Option:selected").text()) {
                alert("未填写装置");
                return false;

            }
            else {
                submitdep = $('#zzId').find("Option:selected").text();
                $.ajax({
                    type: 'POST',
                    url: '/A2/ModifyDong',
                    data: {
                        json1: '{gzqdkf: "' + obj[0].value
                    + '", dqwczcs: "' + obj[1].value
                    + '", jdbhzqdzl: "' + obj[2].value
                    + '", sbgzl: "' + obj[3].value
                    + '", djMTBF: "' + obj[4].value
                    + '", dzdlsbMTBF: "' + obj[5].value
                    + '", zbglys: "' + obj[6].value
                    + '", dnjlphl: "' + obj[7].value
                          + '", kpiid: "' + $('#kpiid').val()//传入kpiid用于定位一行数据
                             + '", zzId: "' + submitdep
                             + '", cjname: "' + $('#cjname').find("Option:selected").text()
                             + '"}'
                    },

                    success: function (data) {

                        if (data) {
                            alert('操作已完成！');
                            location.href = "Index2";
                        } else {
                            alert('操作失败！');
                        }

                    },
                    error: function () {
                        alert('error');
                    }
                });
            }

        }
        if (($('#chaxunmethod').val() == "cj")) {
            //车间的保存方式

        }
    }


    function submit_clickYi() {
        var obj = document.getElementsByName('kpi'); //选择所有name="'KPI'"的对象，返回数组
        //取到对象数组后，我们来循环取出其中的值
        var s = '请选择';
        var submitdep = "";

        for (var i = 0; i < obj.length; i++) {
            if (obj[i].value == "") {
                alert("KPI指标中有未填项！");
                return false;
            }
        }
        if ($('#chaxunmethod').val() == "qc") {

            submitdep = "全厂";
            $.ajax({
                type: 'POST',
                url: '/A2/ModifyYi',
                data: {
                    json1: '{gzqdkf: "' + obj[0].value
                      + '", lsxtzqdzl: "' + obj[1].value
                      + '", kzxtgzcs: "' + obj[2].value
                      + '", ybkzl: "' + obj[3].value
                      + '", ybsjkzl: "' + obj[4].value
                      + '", lsxttyl: "' + obj[5].value
                      + '", gjkzfmgzcs: "' + obj[6].value
                      + '", kzxtgzbjcs: "' + obj[7].value
                      + '", cgybgzl: "' + obj[8].value
                       + '", tjfMDBF: "' + obj[9].value
                        + '", month: "' + $('#SearchMonth').val()//传入kpiid用于定位一行数据
                        + '", zzId: "' + submitdep
                        + '", cjname: "' + $('#cjname').find("Option:selected").text()
                        + '"}'
                },

                success: function (data) {

                    if (data) {
                        alert('操作已完成！');
                        location.href = "Index2";
                    } else {
                        alert('操作失败！');
                    }

                },
                error: function () {
                    alert('error');
                }
            });
        }
        else if ($('#chaxunmethod').val() == "zz") {
            if (s == $('#zzId').find("Option:selected").text()) {
                alert("未填写装置");
                return false;

            }
            else {
                submitdep = $('#zzId').find("Option:selected").text();
                $.ajax({
                    type: 'POST',
                    url: '/A2/ModifyYi',
                    data: {
                        json1: '{gzqdkf: "' + obj[0].value
                     + '", lsxtzqdzl: "' + obj[1].value
                     + '", kzxtgzcs: "' + obj[2].value
                     + '", ybkzl: "' + obj[3].value
                     + '", ybsjkzl: "' + obj[4].value
                     + '", lsxttyl: "' + obj[5].value
                     + '", gjkzfmgzcs: "' + obj[6].value
                     + '", kzxtgzbjcs: "' + obj[7].value
                     + '", cgybgzl: "' + obj[8].value
                      + '", tjfMDBF: "' + obj[9].value
                          + '", kpiid: "' + $('#kpiid').val()//传入kpiid用于定位一行数据
                             + '", zzId: "' + submitdep
                             + '", cjname: "' + $('#cjname').find("Option:selected").text()
                             + '"}'
                    },

                    success: function (data) {

                        if (data) {
                            alert('操作已完成！');
                            location.href = "Index2";
                        } else {
                            alert('操作失败！');
                        }

                    },
                    error: function () {
                        alert('error');
                    }
                });
            }

        }
        if (($('#chaxunmethod').val() == "cj")) {
            //车间的保存方式

        }
    }




    </script>
}






