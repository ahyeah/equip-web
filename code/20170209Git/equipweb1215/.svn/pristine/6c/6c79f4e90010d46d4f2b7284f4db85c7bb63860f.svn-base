
@{
    ViewBag.Title = "CreateAssessGroup";
    Layout = "~/Views/Shared/_LayoutMain.cshtml";
}

<h2>CreateAssessGroup</h2>

 <section>
                <div class="col-md-12">
                    <div class="box box-primary">
                        <div class="box-body no-padding">

                            <form class="form-horizontal">
                                <div class="box-body">

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-2 control-label">评估小组组长:</label>

                                        <div class="col-sm-5 ">
                                            <input id="output_1" data-toggle="modal" data-target="#person" type="text" class="form-control" onclick="Treeinit()" onfocus=this.blur()>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-2 control-label">评估小组组员:</label>

                                        <div class="col-sm-5 ">
                                            <input data-toggle="modal" data-target="#person_multiselect" id="output_2" type=" text" class="form-control" onclick="Treeinit()" onfocus=this.blur()>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-2 col-sm-offset-2 control-label"></label>

                                        <div class="col-sm-5" id="event_output">

                                        </div>
                                    </div>

<!--提交的函数未写，取消已写-->
                                    <div class="box-footer" align="center">
                                        <input type="button"  class="btn btn-info" onclick="" value="提交">
                                        <input type="reset"  class="btn btn-info" onclick="deleteCheck()" value="取消">
                                    </div>

                                </div>
                            </form>

                        </div>


                    </div>
                </div>

  </section>




            <!--以下分别为组长、组员选择的模态框-->

            <!--组长模态框开始处-->
 <div class="modal fade" id="person">
                <div class="modal-dialog ">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title">评估小组组长选择</h4>
                        </div>
                        <div class="modal-body">

                            <div id="treeview1"></div>


                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-warning" data-dismiss="modal" onclick="confirmLeader()">确认</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal">取消</button>
                        </div>
                    </div>

                </div>

  </div><!--组长模态框结束处-->
            
            
  <!--组员模态框开始处-->
            <div class="modal fade" id="person_multiselect">
                <div class="modal-dialog ">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title">评估小组组员选择</h4>
                        </div>
                        <div class="modal-body">

                            <div id="treeview2"></div>


                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-warning" data-dismiss="modal" onclick="confirmMember()">确认</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal">取消</button>
                        </div>
                    </div>

                </div>

            </div>
<!--组员模态框结束处-->

@section js{
    <!-- Page script -->
           <link href="~/Plugins/AdminLTE/plugins/bootstrap-treeview/bootstrap-treeview.min.css" rel="stylesheet" />
           <script src="~/Plugins/AdminLTE/plugins/bootstrap-treeview/bootstrap-treeview.min.js"></script>
           <script type="text/javascript">
                var defaultData = [{
                    text: '财务部',

                    selectable: false, //设置此节点不可选，这是父节点，财务部
                    nodes: [{
                        text: '张三'
                    }, {
                        text: '李四'
                    }]
                },


                    {
                        text: '会计部',
                        selectable: false, //设置此节点不可选，这是父节点，会计部
                        nodes: [{
                            text: '王五'
                        }, {
                            text: '赵六'
                        }]
                    },

                    {
                        text: '工程部',
                        selectable: false,//设置此节点不可选，这是父节点，工程部
                        nodes: [{
                            text: '孙七'
                        }, {
                            text: '周八'
                        }]
                    }

                ];

                //Treeinit()在两个组长、组员的input框被点击是触发，tree初始化
                function Treeinit() {

                    $('#treeview1').treeview({
                        data: defaultData,

                    });

                    $('#treeview2').treeview({
                        data: defaultData,
                        multiSelect: true,//多选的设置
                    });


                    //初始显示时折叠父节点         
                    $('#treeview1').treeview('collapseAll', {
                        silent: true
                    });

                    $('#treeview2').treeview('collapseAll', {
                        silent: true
                    });
                };

                //确认组长的选择   
                function confirmLeader() {

                    var test = $('#treeview1').treeview('getSelected', 1);
                    //alert(test[0].text);

                    for (var j = 0; j < test.length; j++) {
                        $('#output_1').val(test[j].text);
                    }

                }

                //确认组员的选择
                function confirmMember() {
                    $('#event_output').html("");
                    var test = $('#treeview2').treeview('getSelected', 1);

                    //member 为循环选中的组员，以便在input框output_2显示
                    var member = "";
                    for (var j = 0; j < test.length; j++) {
                        $('#event_output').prepend('<p>已选组员： ' + test[j].text + '</p>');

                        if (test[j].text) {
                            member += test[j].text + ',';
                        }
                        $('#output_2').val(member);

                    }

                }


                //取消选择，即重置页面input框和已选择的组员<P></p>中
                function deleteCheck() {
                    $("#event_output p").remove();

                }
            </script>
    }