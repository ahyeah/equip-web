using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using System.Windows.Media;
using System.Windows.Shapes;

namespace FlowDesigner.ConfigItems
{
    /// <summary>
    /// 事件的定制元素
    /// </summary>
    public class ConfigEvent : ConfigItem
    {
        /// <summary>
        /// 宽度
        /// </summary>
        private int nWidth;

        /// <summary>
        /// 高度
        /// </summary>
        private int nHeight;

        /// <summary>
        /// 构造函数
        /// </summary>
        public ConfigEvent()
        {
            nWidth = 150;
            nHeight = 70;

            VisualBrush myVisualBrush = new VisualBrush();

            StackPanel myStackPanel = new StackPanel();
            myStackPanel.Background = new SolidColorBrush(Color.FromRgb(51, 144, 208));

            TextBlock somtext = new TextBlock();
            FontSizeConverter myFontSizeConverter = new FontSizeConverter();
            somtext.FontSize = 0.7F;//(double)myFontSizeConverter.ConvertFrom("6px");
            somtext.FontFamily = new FontFamily("Arial");
            somtext.Text = name + "\r\n" + description;
            somtext.Margin = new Thickness(2);
            myStackPanel.Children.Add(somtext);
            

            myVisualBrush.Visual = myStackPanel;

            Show_item = new Rectangle()
            {
                Width = nWidth,
                Height = nHeight,
                Fill = myVisualBrush,//new SolidColorBrush(Color.FromRgb(51, 144, 208)),
                Stroke = new SolidColorBrush(Color.FromRgb(17, 50, 72)),
                StrokeThickness = 2,
                Cursor = Cursors.Cross,
                Opacity = 0.4,
                RadiusX = 3,
                RadiusY = 3
            };

            builidEventLink();
        }
        
        /// <summary>
        /// 重载设置位置
        /// </summary>
        /// <param name="x"></param>
        /// <param name="y"></param>
        public override void SetPos(int x, int y)
        {
            ((Rectangle)Show_item).Margin = new Thickness(x, y, 0, 0);
            
        }

        protected override void NameChanged()
        {
            ((TextBlock)((StackPanel)((VisualBrush)Show_item.Fill).Visual).Children[0]).Text = name + "\r\n" + description;
        }

        protected override void DescChanged()
        {
            ((TextBlock)((StackPanel)((VisualBrush)Show_item.Fill).Visual).Children[0]).Text = name + "\r\n" + description;
        }

        
    }
}
