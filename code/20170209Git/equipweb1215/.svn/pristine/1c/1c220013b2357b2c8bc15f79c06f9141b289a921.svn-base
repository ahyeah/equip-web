using EquipModel.Entities;
using System;
using System.Collections.Generic;
using System.Data.Entity;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace EquipModel.Context
{
    public class EquipWebContext : DbContext
    {
        public EquipWebContext() : base("EquipWebContext") { }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity<Depart_Archi>().HasMany(s => s.Depart_child).WithOptional(s => s.Depart_Parent);
            modelBuilder.Entity<Person_Info>().HasMany(s => s.Person_roles).WithMany(s => s.Role_Persons).Map( s =>
            {
                s.ToTable("Person_to_Role");
                s.MapLeftKey("Person_Id");
                s.MapRightKey("Role_Id");
            }
            );
            modelBuilder.Entity<Person_Info>().HasMany(s => s.Person_Equips).WithMany(s => s.Equip_Manager).Map(s =>
            {
                s.ToTable("Person_to_Equip");
                s.MapLeftKey("Person_Id");
                s.MapRightKey("Equip_Id");
            }
            );
            modelBuilder.Entity<Equip_Archi>().HasMany(s => s.EA_Childs).WithOptional(s => s.EA_Parent);

            base.OnModelCreating(modelBuilder);
        }
        //系统菜单表
        public DbSet<Menu> Sys_Menus { get; set; }

        //组织结构
        public DbSet<Depart_Archi> Department { get; set; }

        //职员信息
        public DbSet<Person_Info> Persons { get; set; }

        //角色信息
        public DbSet<Role_Info> Roles { get; set; }

        //设备组织结构
        public DbSet<Equip_Archi> EArchis { get; set; } 

        //设备信息
        public DbSet<Equip_Info> Equips { get; set; }

        ////基础数据表
        //public DbSet<PqInfo> Sys_PqInfos { get; set; }
        //public DbSet<CjInfo> Sys_CjInfos { get; set; }
        //public DbSet<ZzInfo> Sys_ZzInfos { get; set; }
        //public DbSet<SbInfo> Sys_SbInfos { get; set; }
        //public DbSet<RoleInfo> Sys_RoleInfos { get; set; }
        //public DbSet<UserInfo> Sys_UserInfos { get; set; }

        //public DbSet<User2Sb> Sys_User2Sbs { get; set; }
        //public DbSet<User2Zz> Sys_User2Zzs { get; set; }
        //public DbSet<Role2Authority> Sys_Role2Authoritys { get; set; }
        //public DbSet<User2Authority> Sys_User2Authoritys { get; set; }
    }
}
